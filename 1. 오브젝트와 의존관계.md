# 



## 1.1 초난감 DAO

- DAO(Data Acess Object) : DB를 사용해 데이터를 조회하거나 조작하는 기능을 전담하도록 만든 오브젝트

1. User

   - 사용자 정보를 저장할 때는 자바빈 규약을 따르는 오브젝트를 이용 

   - 사용자 정보를 저장할 경우 User 클래스 생성

   - ```
     public class user {
     	String id;
     	String name;
     	String password;
     	
     	public String getId() {
     		return id;
     	}
     	public void setId(String id) {
     		this.id = id;
     	}
     	public String getName() {
     		return name;
     	}
     	public void setName(String name) {
     		this.name = name;
     	}
     	public String getPassword() {
     		return password;
     	}
     	public void setPassword() {
     		this.password = password;
     	}
     	
     }
     ```

     클래스를 만들었음으로 DB를 생성할 차례

     ```
     creat table users (
     	id varchar(10) primary key,
     	name varchar(20) not null,
     	password varchar(10) not null
     	)
     ```

2. UserDao

   - 사용자 정보를 DB에 넣고 관리할 수 있는 DAO 클래스

   - JDBC : Java DataBase Connetivity

   - JDBC를 이용하는 작업의 일반적인 순서

     1. DB 연결을 위한 Connection 가져오기
     2. SQL을 담은 Statement(or PrepareStatement) 만들기
     3. 만들어진 Statement 실행
     4. 조회의 경우  SQL 쿼리의 실행 결과를 ResultSet으로 받아서 정보를 저장할 오브젝트(여기서 User)에 옮겨준다
     5. 작업 중에 생성된 Connection, Statement, ResultSet 같은 리소스는 작업을 마친 후 반드시 닫아준다
     6. JDBC API가 만들어내는 예외를 잡아서 직접 처리하거나 메소드에 throws를 선언하여 메소드 밖으로 던진다.

   - Class.forName() : 드라이버 로드

     DriverManager.getConnection() : DB 서버 연결

     ```
     public class UserDao {
     	public void add(User user) throws ClassNotFoundException, SQLException {
     		Class.forName("com.mysql.jdbc.Driver");
     		Connection c = DriverManager.getConnection("jdbc:mysql://localhost/springbook", "spring", "book");
     		
     		PreparedStatement ps = c.prepareStatement("insert into users(id, name, password) values(?,?,?)");
     		ps.setString(1, user,getId());
     		ps.setString(2, user,getName());
     		ps.setString(3, user.getPassword());
     		
     		ps.execteUpdate();
     		
     		ps.close();
     		c.close();
     	}
     	
     	public User get(String id) throws ClassNotFountException, SQLException {
     		Class.forName("com.mysql.jdbc.Driver");
     		Connection c = DriverManager.getConnection("jdbc:mysql://localhost/springbook", "spring", "book");
     		
     		PrepareStatement ps = c.prepareStatement("select * from users where id = ?");
     		ps.setString(1, id);
     		
     		ResultSet rs = ps.executeQuery();
     		rs.next();
     		User user = new User();
     		user.setId(rs.getString("id"));
     		user.setName(rs.getString("name"));
     		user.setPassword(rs.getString("password"));
     		
     		rs.close();
     		ps.close();
     		c.close();
     		
     		return user;
     		
     	}
     }
     ```

3. main()을 이용한 DAO 테스트 코드

   - ```
     public static void main(String[] args) throws ClassNotFoundException, SQLException {
     	UserDao dao = new UserDao();
     	
     	User user = new User();
     	user.setId("whiteship");
     	user.setName("백기선");
     	user.setPassword("married");
     	
     	dao.add(user);
     	
     	System.out.println(user.getId() + " 등록 성공");
     	
     	User user2 = dao.get(user.getId());
     	System.out.println(user2.getName());
     	System.out.println(user2.getPassword());
     	System.out.println(user2.getId() + " 조회 성공");
     }
     ```

     

   

   

